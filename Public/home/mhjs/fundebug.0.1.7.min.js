!function(e){function t(e,t,n){var r=e[t];e[t]=n(r)}function n(e){return"function"!=typeof e?e:(e.__injected__||(e.__injected__=function(){try{return e.apply(this,arguments)}catch(e){throw u(e),y=!0,e}}),e.__injected__)}function r(e){var t=/^[0-9a-z]{64}$/i;return!(!e||!e.match(t))}function a(e){return e?{name:e&&e.name,message:e&&e.message,fileName:e&&e.fileName||e&&e.sourceURL,lineNumber:e&&e.lineNumber||e&&e.line,columnNumber:e&&e.columnNumber||e&&e.column}:null}function i(){var e;try{throw new Error("")}catch(t){e=t.stack}if(e)return e=e.replace(/(.*?)fundebug(.*?)\.js(.*)\n?/gm,""),e=e.replace(/^Error\n/g,""),e="generated-stack:\n"+e}function o(){for(var e,t=[],n=arguments.callee.caller.caller;n&&t.length<10;){var r=n.toString().match(/function\s*([\w\_$]+)?\s*\(/i);e=r&&r[1]||"[anonymous]",t.push(e),n=n.caller}return"generated-stack:\n"+t.join("\n")}function u(e){if(e){var t=e.stack;t=t.replace(/(.*?)fundebug(.*?)\.js(.*)\n?/gm,"");var n=a(e);d({name:n.name||"uncaught error",message:n.message,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,stacktrace:t,severity:"error",type:"uncaught"})}}function s(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r='"'+n+'":',a=e[n];a&&("object"==typeof a?r+=s(a):"number"==typeof a?r+=a:r=r+'"'+a.replace(/\n/g,"\\n")+'"',t.push(r))}return"{"+t.join(",")+"}"}function c(e){for(var t=[];e&&e.nodeType==Node.ELEMENT_NODE;e=e.parentNode){var n,r=0,a=!1;for(n=e.previousSibling;n;n=n.previousSibling)n.nodeType!=Node.DOCUMENT_TYPE_NODE&&n.nodeName==e.nodeName&&++r;for(n=e.nextSibling;n&&!a;n=n.nextSibling)n.nodeName==e.nodeName&&(a=!0);var i=(e.prefix?e.prefix+":":"")+e.localName,o=r||a?"["+(r+1)+"]":"";t.splice(0,0,i+o)}return t.length?"/"+t.join("/"):null}function l(e){for(var t=[];e.parentNode;){if(e.id){t.unshift("#"+e.id);break}if(e==e.ownerDocument.documentElement)t.unshift(e.tagName);else{for(var n=1,r=e;r.previousElementSibling;r=r.previousElementSibling,n++);t.unshift(e.tagName+":nth-child("+n+")")}e=e.parentNode}return t.join(" > ")}function m(e){E.push(e),E.length>20&&E.shift()}function f(t){var n,r=(n=t.target?t.target:t.srcElement)&&n.outerHTML;r&&r.length>200&&(r=r.slice(0,200)),m({type:"click",page:{url:e.location.href,title:document.title},detail:{outerHTML:r,tagName:n&&n.tagName,id:n&&n.id,className:n&&n.className,name:n&&n.name},time:(new Date).getTime()})}function p(e,t){T=t,m({type:"navigation",detail:{from:e,to:t},time:(new Date).getTime()})}function d(t){if(r(N.getAttribute("apikey")||v.apikey)&&v.maxEventNumber&&!v.silent){v.maxEventNumber-=1;var n={notifierVersion:"0.1.7",userAgent:e.navigator.userAgent,locale:e.navigator.language||e.navigator.userLanguage,url:e.location.href,title:document.title,appVersion:N.getAttribute("appversion")||v.appversion,apiKey:N.getAttribute("apikey")||v.apikey,releaseStage:N.getAttribute("releasestage")||v.releasestage,metaData:t.metaData||v.metaData,user:t.user||v.user,name:t.name,time:(new Date).getTime(),message:t.message,fileName:t.fileName,lineNumber:t.lineNumber,columnNumber:t.columnNumber,stacktrace:t.stacktrace,type:t.type,severity:t.severity,target:t.target,req:t.req,res:t.res,breadcrumbs:E};n.userAgent&&n.userAgent.match(/Googlebot/)||g(n)}}function g(t){var n;if(n="undefined"==typeof JSON?s(t):JSON.stringify(t),e.XMLHttpRequest&&e.atob){var r=new XMLHttpRequest;r.Fundebug=!0,r.open("POST","https://fundebug.com/javascript/"),r.setRequestHeader("Content-Type","application/json"),r.send(n)}else(new Image).src=h+"?event="+encodeURIComponent(n)}var h="https://fundebug.com/javascript/",v={};e.fundebug=v;var y=!1,N=function(){var e=document.currentScript;if(!e){var t=document.scripts;e=t[t.length-1]}return e}();v.silent=N.getAttribute("silent")||!1,v.maxEventNumber=N.getAttribute("maxEventNumber")||10,v.silentResource=N.getAttribute("silentResource")||!1,v.silentHttp=N.getAttribute("silentHttp")||!1,t(e,"onerror",function(){return function(t,n,r,i,u){if(y)y=!1;else{void 0===i&&e.event&&(i=e.event.errorCharacter);var s;s=n&&n!==e.location.href?n:null;var c=a(u);d({message:t,lineNumber:r,columnNumber:i,fileName:s||c&&c.fileName,name:c&&c.name||"uncaught error",stacktrace:u&&u.stack||o(),severity:"error",type:"uncaught"})}}});var b=!0;if(e.atob){if(e.ErrorEvent)try{e.ErrorEvent.prototype.hasOwnProperty("error")&&(b=!1)}catch(e){}}else b=!1;"EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload".replace(/\w+/g,function(r){if(b){var a=e[r]&&e[r].prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(t(a,"addEventListener",function(e){return function(t,r,a,i){return r&&r.handleEvent&&(r.handleEvent=n(r.handleEvent)),e.call(this,t,n(r),a,i)}}),t(a,"removeEventListener",function(e){return function(t,r,a){return e.call(this,t,r,a),e.call(this,t,n(r),a)}}))}}),v.notify=function(e,t,n){if(e)return d({name:e||n&&n.name,message:t||n&&n.message,severity:n&&n.message||"warning",stacktrace:i(),type:"notification",user:n&&n.user,metaData:n&&n.metaData}),"fundebug.com"===location.host?"亲，不要在Fundebug网站测试哦；请将Fundebug插件集成到您的网站，然后进行测试!":"请查看邮箱以及Fundebug控制台!"},v.notifyError=function(e,t){if(e){var n=a(e);d({name:n.name||t&&t.name||"caught error",message:n.message||t&&t.message,stacktrace:e.stack,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,severity:t&&t.severity||"error",type:"caught",user:t&&t.user,metaData:t&&t.metaData})}},v.notifyHttpError=function(e,t,n){d({type:"httpError",req:e,res:t,user:n&&n.user,metaData:n&&n.metaData})},e.addEventListener&&e.addEventListener("unhandledrejection",function(e){v.notifyError(e.reason)}),e.addEventListener&&e.addEventListener("error",function(t){var n,r=(n=t.target?t.target:t.srcElement)&&n.outerHTML;r&&r.length>200&&(r=r.slice(0,200));var a={type:"resourceError",target:{outerHTML:r,src:n&&n.src,tagName:n&&n.tagName,id:n&&n.id,className:n&&n.className,name:n&&n.name,type:n&&n.type,XPath:c(n),selector:l(n)}};if(n.src!==e.location.href&&(!n.src||!n.src.match(/.*\/(.*)$/)||n.src.match(/.*\/(.*)$/)[1])&&a.target.src&&e.XMLHttpRequest){var i=new XMLHttpRequest;i.Fundebug=!0,i.open("HEAD",a.target.src),i.send(),i.onload=function(e){200!==e.target.status&&(a.target.status=e.target.status,a.target.statusText=e.target.statusText),d(a)}}},!0);var E=[];e.addEventListener?e.addEventListener("click",f,!0):document.attachEvent("onclick",f);var T={url:e.location.href};document.addEventListener?document.addEventListener("DOMContentLoaded",function(){T={url:e.location.href,title:document.title}}):document.attachEvent("onreadystatechange",function(){T={url:e.location.href,title:document.title}});var L=e.onpopstate;e.onpopstate=function(){var t={url:e.location.href};if(T.title||(T.title=document.title),T.url!==t.url&&p(T,t),L)return L.apply(this,arguments)};var k=e.history.pushState;e.history.pushState=function(){T={url:e.location.href,title:document.title};var t={};if(3===arguments.length&&(t.url=arguments[2]),T.url!==t.url&&p(T,t),k)return k.apply(this,arguments)};var w=e.onhashchange;if(e.onhashchange=function(){var t={url:e.location.href,title:document.title};if(T.url!==t.url&&p(T,t),w)return w.apply(this,arguments)},e.XMLHttpRequest){var D=XMLHttpRequest.prototype;if(!D)return;var H,x,M=D.open,S=D.send;D.open=function(e,t){return H=e,x=t,M.apply(this,arguments)},D.send=function(){var t=this,n=t.onreadystatechange;return t.onreadystatechange=function(){if(4===t.readyState&&!t.Fundebug&&x!=h){var r={type:"XMLHttpRequest",page:{url:e.location.href},detail:{method:H,url:t.responseURL||x,status:t.status,statusText:t.statusText},time:(new Date).getTime()};if(!v.silentHttp&&2!==parseInt(t.status/100)){var a={method:r.detail.method,url:r.detail.url},i={status:t.status,statusText:t.statusText,response:t.response};v.notifyHttpError(a,i)}m(r)}n&&n.apply(this,arguments)},S.apply(this,arguments)}}if(e.fetch){var R=e.fetch;e.fetch=function(t,n){return R.apply(this,arguments).then(function(t){var r={type:"fetch",page:{url:e.location.href,title:document.title},detail:{method:n&&n.method||"GET",url:t.url,status:t.status,statusText:t.statusText},time:(new Date).getTime()};if(!v.silentHttp&&2!==parseInt(t.status/100)){var a={method:r.detail.method,url:r.detail.url},i={status:t.status,statusText:t.statusText};v.notifyHttpError(a,i)}return m(r),t})}}var _="function"==typeof define,q="undefined"!=typeof module&&module.exports;_?define(v):q&&(module.exports=v)}(window);